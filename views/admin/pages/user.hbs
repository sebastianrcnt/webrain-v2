{{> admin/navbar }}
<div class="px-3 pb-6">
  <div class="container">
    <h1 class="title">유저 상세</h1>
    <form action="/admin/users/{{ user.email }}" method="POST">
      <div class="columns">
        <label for="name" class="column">
          이름
          <input type="text" class="input" name="name" id="" value="{{ user.name }}" disabled />
        </label>
      </div>
      <div class="columns">
        <label for="name" class="column">
          이메일
          <input type="email" class="input" name="email" id="" value="{{ user.email }}" disabled />
        </label>
      </div>
      <div class="columns">
        <label for="name" class="column">
          전화번호
          <input type="phone" class="input" name="phone" id="" value="{{ user.phone }}" disabled />
        </label>
      </div>
      <div class="columns">
        <label for="level" class="column">
          권한 설정
          <input type="number" class="input" name="level" id="" value="{{ user.level }}" />
        </label>
      </div>
      <div class="content mt-6">
        <h6>유저 레벨 안내</h6>
        <ol>
          <li>0 ~ 99: <code>실험대상자</code></li>
          <li>100 ~ 199: <code>연구자</code></li>
          <li>200 ~: <code>관리자</code></li>
        </ol>
      </div>
      <div class="row mt-3">
        <button type="submit" class="button is-success is-pulled-right">저장하기</button>
      </div>
      <div class="row mt-3">
        <button type="button" id="delete-this-user"
          class="button is-danger is-pulled-right delete-this-user">삭제하기</button>
      </div>
    </form>
  </div>
</div>
<script>
  $(document).ready(() => {
    $('#delete-this-user').on('click', () => {
      $.ajax({
        method: "delete",
        url: "/api/users/{{user.email}}"
      }).then(() => {
        alert('삭제되었습니다.')
        window.location.href = "/admin/users"
      }).catch(() => {
        alert('삭제에 실패했습니다')
      }).always((response) => {
        console.log(response)
      })
    })
  });
</script>